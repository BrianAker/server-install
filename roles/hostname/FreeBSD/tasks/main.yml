---
- command: "hostname {{ inventory_hostname }}"
  become: yes
  when: is_ipaddress|failed
  tags: config

- name: set hostname in rc.local
  become: yes
  lineinfile: dest=/etc/rc.local
              state=present
              regexp='^#?{{ item.key }}='
              line='{{ item.key }}="{{ item.value }}"'
  with_items:
    - { key: 'hostname', value: inventory_hostname }
  when: is_ipaddress|failed
  tags: config
