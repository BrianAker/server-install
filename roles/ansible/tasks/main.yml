--- # vim:ft=yaml

- include: facts.yaml

- include: validate.yaml

- include: RedHat.yml
  when: ansible_os_family == 'RedHat'

- include: Debian.yml
  when: ansible_os_family == 'Debian'

- include: MacOSX.yml
  when: ansible_distribution == 'MacOSX'

- include: adduser.yml
  when: User is defined

- hosts: 'apt' 
  tasks:
  - name: apt-get install common_packages
    sudo: yes
    apt: 
      name: "{{ item }}"
      update_cache: yes
      cache_valid_time: 3600 
      state: present
    with_items: ansible_packages[ansible_distribution]
    tags: package_install

- hosts: 'yum'
  tasks:
  - name: install packages with yum
    yum:
      name: "{{ item }}"
      state: present
    with_items: ansible_packages[ansible_distribution]
    sudo: yes
    tags: package_install

- hosts: 'pkgng'
  tasks:
  - name: "pkgng install common_packages"
    sudo: yes
    pkgng:
      name: "{{ item }}"
      state: present
    with_items: ansible_packages[ansible_distribution]
    tags: package_install
