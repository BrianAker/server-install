---
- name: include vars
  include_vars: "{{ item }}"
  with_first_found:
    - files:
        - "{{ ansible_distribution }}.yml"
        - "{{ ansible_os_family }}.yml"
      paths: "{{ inventory_dir }}/roles/adduser/vars/"

- fail: "username was not defined."
  when: username is not defined

- debug: msg="Adding user {{ username }}"

- name: create user
  sudo: yes
  user: name="{{ username }}"
        comment="{{ username }}"
        state=present
        shell={{ default_shell }}
        generate_ssh_key="yes"
  when: "ansible_distribution != 'MacOSX'"

