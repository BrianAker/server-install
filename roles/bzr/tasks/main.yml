---

- name: mkdir bazaar directory
  sudo: yes
  sudo_user: "{{ username }}"
  file: path="{{ item }}"
        state=directory
        mode=0750
  with_items: 
    - "~/.bazaar/plugins"

- get_url:  url="{{ item.url }}"
            dest="{{ ansible.env.TMPDIR }}/{{ item.tarfile }}"
  with_items:
    - bazaar.bzr
    - bazaar.bzr_rewrite

- command:  tar xzf {{ item.tarfile }}
            chdir="{{ ansible.env.TMPDIR }}"
            creates="{{ ansible.env.TMPDIR }}/{{ item.project }}"
  with_items:
    - bazaar.bzr
    - bazaar.bzr_rewrite

- command:  python setup.py install
            chdir="{{ ansible.env.TMPDIR }}/{{ item.project }}"
            creates="{{ item.check }}"
  with_items:
    - bazaar.bzr
    - bazaar.bzr_rewrite
